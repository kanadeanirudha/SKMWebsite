
@{
    Layout = null;
}
<footer>
    <div class="financity-footer-wrapper ">
        <!-- Floating Notification Span -->
        @if (TempData["success"] != null)
        {
            <div id="toast" class="floating-toast success">
                @TempData["success"]
            </div>
        }
        @if (TempData["error"] != null)
        {
            <div id="toast" class="floating-toast error">
                @TempData["error"]
            </div>
        }

        <div class="financity-footer-container financity-container clearfix">
            <div class="financity-footer-column financity-item-pdlr financity-column-15">
                <div id="text-2" class="widget widget_text financity-widget">
                    <div class="textwidget">
                        <p><img src="~/Images/sk-logo-2.png" alt=""></p>
                        <p>
                            <i class="fa fa-location-arrow" style="font-size: 16px;color: #ffffff;margin-right: 10px;"></i>&nbsp;Unit 1 /54 Wordsworth street Sydenham Christchurch 8061,<br /> New Zealand
                            <br> <span class="gdlr-core-space-shortcode" style="margin-top: 10px;"></span>
                            <i class="fa fa-phone" style="font-size: 16px;color: #ffffff;margin-right: 10px;"></i> <a href="tel:0212083152">0 21 208 3152</a>
                            <br> <span class="gdlr-core-space-shortcode" style="margin-top: 10px;"></span> <i class="fa fa-envelope-open-o" style="font-size: 16px;color: #ffffff;margin-right: 10px;"></i> <a href="mailto:admin@skfinance.co.nz">admin@skfinance.co.nz</a>
                            <br> <span class="gdlr-core-space-shortcode" style="margin-top: 10px;"></span>

                            <i class="fa fa-clock-o" style="font-size: 17px;color: #ffffff;margin-right: 10px;"></i>
                            <span style="color: #e0004d;">Mon - Wed - 05:00-16:00</span><br />
                            <i class="fa fa-clock-o" style="font-size: 17px;color: #ffffff;margin-right: 10px;"></i>
                            <span style="color: #e0004d;">Thurs - Fri - 08:00-16:30</span><br />
                            <i class="fa fa-clock-o" style="font-size: 17px;color: #ffffff;margin-right: 10px;"></i>
                            <span style="color: #e0004d;">Sat - Sun - Only Appointment</span><br />
                            <a href="https://www.instagram.com/skmortgagesnz/?igsh=bXM1cDZja3Q2dmNp" target="_blank">
                                <i class="fa fa-instagram" style="font-size: 17px; color: #ffffff; margin-right: 10px;"></i>
                                <span style="color: #e0004d;">Instagram</span>
                            </a><br />
                            <a href="https://www.facebook.com/Sandeepkhanna.mortgages" target="_blank">
                                <i class="fa fa-facebook" style="font-size: 17px; color: #ffffff; margin-right: 15px;"></i>
                                <span style="color: #e0004d;">Facebook</span>
                            </a><br />
                        </p>
                    </div>
                </div>
            </div>

            <div class="financity-footer-column financity-item-pdlr financity-column-15">
                <div id="nav_menu-1" class="widget widget_nav_menu financity-widget">
                    <h3 class="financity-widget-title">Useful Links</h3>
                    <div class="menu-useful-links-container">
                        <ul id="menu-useful-links" class="menu">
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5507">
                                <a href="../home/aboutus">About Us</a>
                            </li>
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5506">
                                <a href="../home/ourservices">Our Services</a>
                            </li>
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5512">
                                <a href="../home/calculator">Calculator</a>
                            </li>
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5508">
                                <a href="../home/downloads">Downloads</a>
                            </li>
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5509">
                                <a href="../home/reviews">Reviews</a>
                            </li>
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5509">
                                <a href="~/Attachments/Privacy-Policy.pdf" target="_blank">Privacy Policy</a>
                            </li>
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5509">
                                <a href="~/Attachments/skm-disclosure-24.pdf" target="_blank">Disclosure Form</a>
                            </li>
                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5509">
                                <a href="../home/faq">FAQ</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="financity-footer-column financity-item-pdlr financity-column-30">
                <div id="text-4" class="widget widget_text financity-widget">
                    <h3 class="financity-widget-title">Contact Form</h3>
                    <div class="textwidget">
                        <div role="form" class="wpcf7" id="wpcf7-f5505-o2" lang="en-US" dir="ltr">
                            <div class="screen-reader-response"></div>
                            <form id="contact" action="/home/SendEmail" method="post" class="wpcf7-form" onsubmit="return validateCaptcha(event)">
                                @Html.AntiForgeryToken()
                                <input type="text" name="website" style="display:none;">
                                <div class="gdlr-core-input-wrap gdlr-core-small gdlr-core-full-width gdlr-core-with-column gdlr-core-no-border">
                                    <div class="gdlr-core-column-60">
                                        <span class="wpcf7-form-control-wrap your-name">

                                            <input id="name" type="text" name="name" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" aria-required="true" aria-invalid="false" placeholder="Full Name*" oninput="this.value=this.value.replace(/[^a-zA-Z\s]/g,'');">
                                            <span class="text-danger" style="color: red; font-size: 0.9em; margin-top: 5px;"></span>
                                        </span>
                                    </div>
                                    <div class="clear"></div>
                                    <div class="gdlr-core-column-60">
                                        <span class="wpcf7-form-control-wrap your-email">
                                            <input type="email" name="email" id="email" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-email wpcf7-validates-as-required wpcf7-validates-as-email" aria-required="true" aria-invalid="false" placeholder="Email*">
                                            <span class="text-danger" style="color: red; font-size: 0.9em; margin-top: 5px;"></span>
                                        </span>
                                    </div>
                                    <div class="clear"></div>
                                    <div class="gdlr-core-column-60">
                                        <span class="wpcf7-form-control-wrap your-email">
                                            <input type="number" name="phonenumber" id="phonenumber" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-email wpcf7-validates-as-required wpcf7-validates-as-email" aria-required="true" aria-invalid="false" placeholder="Phone Number*" oninput="this.value=this.value.replace(/[^0-9]/g,'');">
                                            <span class="text-danger" style="color: red; font-size: 0.9em; margin-top: 5px;"></span>
                                        </span>
                                    </div>
                                    <div class="clear"></div>
                                    <div class="gdlr-core-column-60">
                                        <span class="wpcf7-form-control-wrap your-message">
                                            <textarea name="message" id="message" cols="40" rows="10" class="wpcf7-form-control wpcf7-textarea wpcf7-validates-as-required" aria-required="true" aria-invalid="false" placeholder="Message*"></textarea>
                                            <span class="text-danger" style="color: red; font-size: 0.9em; margin-top: 5px;"></span>
                                        </span>
                                    </div>
                                    <div id="footercaptchaContainer" style="margin-bottom: 10px;"></div>
                                    <input type="text"
                                           id="cpatchaTextBox"
                                           placeholder="Enter Captcha"
                                           style="width: 100%; padding: 12px 20px; display: inline-block; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; margin-bottom: 10px;" />
                                    <div class="gdlr-core-column-60 gdlr-core-left-align">
                                        <input type="submit" value="Submit Now" class="wpcf7-form-control wpcf7-submit gdlr-core-small">
                                    </div>
                                </div>
                                <div class="wpcf7-response-output wpcf7-display-none"></div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="financity-copyright-wrapper">
        <div class="financity-copyright-container financity-container clearfix">
            <div class="financity-item-pdlr" style="text-align:center;">Copyright @System.DateTime.Now.Year. Website Design & Developed By <a href="#" target="_blank"><strong style="color:#ffffff;">Coditech Innovations Pvt. Ltd</strong></a></div>
            <!--<div class="financity-copyright-right financity-item-pdlr">
                <a href="https://www.facebook.com/Sandeepkhanna.mortgages" target="_blank"><i class="fa fa-facebook" style="font-size: 16px;color: #ffffff;margin-left: 17px;"></i></a>-->
                @*<a href="#" target="_self"><i class="fa fa-twitter" style="font-size: 16px;color: #ffffff;margin-left: 17px;"></i></a>
                    <a href="#" target="_self"><i class="fa fa-linkedin" style="font-size: 16px;color: #ffffff;margin-left: 17px;"></i></a>
                    <a href="#" target="_self"><i class="fa fa-google-plus" style="font-size: 16px;color: #ffffff;margin-left: 17px;"></i></a>*@
                <!--<a href="https://www.instagram.com/skmortgagesnz/?igsh=bXM1cDZja3Q2dmNp" target="_blank"><i class="fa fa-instagram" style="font-size: 16px;color: #ffffff;margin-left: 17px;"></i></a>
            </div>-->
        </div>
    </div>
</footer>
<script>
    document.addEventListener("DOMContentLoaded", function () {

        // Select input elements
        const nameInput = document.getElementById("name");
        const emailInput = document.getElementById("email");
        const phoneInput = document.getElementById("phonenumber");
        const messageInput = document.getElementById("message");
        const submitButton = document.getElementById("submitButton");
       let code; // Declare at the top so it's accessible to all functions

  function createCaptcha() {
    // now you can assign to code safely
    document.getElementById('footercaptchaContainer').innerHTML = "";

    const charsArray = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\s@{}" + "!#$%^&*";
    const captchaLength = 6;
    let captcha = [];

    while (captcha.length < captchaLength) {
      const char = charsArray.charAt(Math.floor(Math.random() * charsArray.length));
      if (!captcha.includes(char)) captcha.push(char);
    }

    const canvas = document.createElement("canvas");
    canvas.width = 100;
    canvas.height = 50;
    canvas.style.pointerEvents = "none";

    const ctx = canvas.getContext("2d");

    // Draw background (optional)
    ctx.fillStyle = "#000"; // black background
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Draw captcha text
    ctx.font = "25px Georgia";
    ctx.fillStyle = "white";
    const captchaText = captcha.join("");
    ctx.fillText(captchaText, 0, 30);

    // Draw random strike-through lines with random angles and positions
    ctx.strokeStyle = "red"; // color of strike-through lines
    ctx.lineWidth = 1.5;

    const numberOfLines = 5; // number of random strike-through lines

    for (let i = 0; i < numberOfLines; i++) {
      // Random start point anywhere on the canvas
      const startX = Math.random() * canvas.width;
      const startY = Math.random() * canvas.height;

      // Random angle in radians between -45° and 45° (approx)
      const angle = (Math.random() * 90 - 45) * (Math.PI / 180);

      // Random length between 50 and 100 pixels
      const length = 50 + Math.random() * 50;

      // Calculate end point based on angle and length
      const endX = startX + length * Math.cos(angle);
      const endY = startY + length * Math.sin(angle);

      // Draw the line
      ctx.beginPath();
      ctx.moveTo(startX, startY);
      ctx.lineTo(endX, endY);
      ctx.stroke();
    }
        code = captcha.join("");
        document.getElementById("footercaptchaContainer").appendChild(canvas);
    }

  function validateCaptcha(event) {
     event.preventDefault();

    const userInput = document.getElementById('cpatchaTextBox').value;
    if (userInput === code) {
      event.target.submit();
    } else {
      alert("Invalid Captcha. Try Again.");
      createCaptcha();
      document.getElementById('cpatchaTextBox').value = "";
    }
  }

  createCaptcha();


  document.getElementById("contact").addEventListener("submit", validateCaptcha);
        // Attach validation functions
        [nameInput, emailInput, phoneInput, messageInput].forEach(input => {
            input.addEventListener("blur", () => validateInput(input));
            input.addEventListener("input", () => validateInput(input));
        });

        // Validation Functions
        function validateInput(input) {
            const errorSpan = input.nextElementSibling;
            let isValid = true;

            switch(input.id) {
                case "name":
                    isValid = /^[a-zA-Z\s]+$/.test(input.value.trim());
                    errorSpan.textContent = isValid ? "" : "Name can only contain letters and spaces (no numbers or symbols)";
                    break;
                case "email":
                    const emailRegex = /^[^\s@{}]+@{}[^\s@{}]+\.[^\s@{}]+$/;
                    isValid = emailRegex.test(input.value.trim());
                    errorSpan.textContent = isValid ? "" : "Enter a valid email address";
                    break;
                case "phonenumber":
                    const phoneRegex = /^\d{10}$/;
                    isValid = phoneRegex.test(input.value.trim());
                    errorSpan.textContent = isValid ? "" : "Phone number must be exactly 10 digits";
                    break;
                case "message":
                    isValid = input.value.trim().length >= 10;
                    errorSpan.textContent = isValid ? "" : "Message must be at least 10 characters long";
                    break;
            }

            input.classList.toggle("error", !isValid);
            validateForm();
        }

        // Validate the form to enable/disable submit button
        function validateForm() {
            const allValid = [nameInput, emailInput, phoneInput, messageInput].every(input => !input.classList.contains("error") && input.value.trim());
            submitButton.disabled = !allValid;
        }
    });
</script>